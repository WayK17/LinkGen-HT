<html>
  <head>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&amp;family=Inter%3Awght%40400%3B500%3B700%3B900&amp;family=Noto+Sans%3Awght%40400%3B500%3B700%3B900"
    />

    <title>LinkGen - Generador de Enlaces</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  </head>
  <body>
    <div class="relative flex size-full min-h-screen flex-col bg-[#111418] dark group/design-root overflow-x-hidden" style='font-family: Inter, "Noto Sans", sans-serif;'>
      <div class="layout-container flex h-full grow flex-col">
        <header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-b-[#283039] px-10 py-3">
          <div class="flex items-center gap-4 text-white">
            <div class="size-4">
              <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g clip-path="url(#clip0_6_330)">
                  <path
                    fill-rule="evenodd"
                    clip-rule="evenodd"
                    d="M24 0.757355L47.2426 24L24 47.2426L0.757355 24L24 0.757355ZM21 35.7574V12.2426L9.24264 24L21 35.7574Z"
                    fill="currentColor"
                  ></path>
                </g>
                <defs>
                  <clipPath id="clip0_6_330"><rect width="48" height="48" fill="white"></rect></clipPath>
                </defs>
              </svg>
            </div>
            <h2 class="text-white text-lg font-bold leading-tight tracking-[-0.015em]">LinkGen</h2>
          </div>
          <div class="flex flex-1 justify-end gap-8">
            <div class="flex items-center gap-9">
              <a class="text-white text-sm font-medium leading-normal" href="#">Inicio</a>
              <a class="text-white text-sm font-medium leading-normal" href="#">Acerca de</a>
              <a class="text-white text-sm font-medium leading-normal" href="#">Contacto</a>
            </div>
          </div>
        </header>
        <main class="px-40 flex flex-1 justify-center py-5">
          <div class="layout-content-container flex flex-col max-w-[960px] flex-1 items-center">
            <h2 class="text-white tracking-light text-[28px] font-bold leading-tight px-4 text-center pb-3 pt-5">Genera Enlaces de Descarga Directa</h2>
            <p class="text-white text-base font-normal leading-normal pb-3 pt-1 px-4 text-center">Pega tu enlace de Mediafire abajo para generar un enlace de descarga directa.</p>
            <div class="flex w-full max-w-[480px] flex-wrap items-end gap-4 px-4 py-3">
              <label class="flex flex-col min-w-40 flex-1">
                <input
                  id="mediafire-input"
                  placeholder="Ingresa el Enlace de Mediafire"
                  class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-white focus:outline-0 focus:ring-0 border border-[#3b4754] bg-[#1b2127] focus:border-[#3b4754] h-14 placeholder:text-[#9caaba] p-[15px] text-base font-normal leading-normal"
                />
              </label>
            </div>
            <div class="flex px-4 py-3 justify-center">
              <button
                id="generate-button"
                class="flex min-w-[84px] w-full max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 px-4 bg-[#0b79ee] text-white text-sm font-bold leading-normal tracking-[0.015em]"
              >
                <span class="truncate">Generar Enlace</span>
              </button>
            </div>
            
            <div id="results-container" class="w-full max-w-[480px] mt-8 p-4 rounded-lg">
                <h2 class="text-white text-[22px] font-bold leading-tight tracking-[-0.015em] px-4 pb-3 pt-5 text-center">Resultado</h2>
                <p id="results-placeholder" class="text-white text-base font-normal leading-normal pb-3 pt-1 px-4 text-center">Tu enlace de descarga directa aparecerá aquí.</p>
            </div>

          </div>
        </main>
      </div>
    </div>

    <script>
        // 1. Seleccionar los elementos importantes del HTML por su ID
        const generateButton = document.getElementById('generate-button');
        const mediafireInput = document.getElementById('mediafire-input');
        const resultsContainer = document.getElementById('results-container');
        const resultsPlaceholder = document.getElementById('results-placeholder');

        // 2. Añadir un "escuchador" de eventos al botón
        generateButton.addEventListener('click', async () => {
            const mediafireUrl = mediafireInput.value;

            // Validación simple
            if (!mediafireUrl || !mediafireUrl.startsWith('https://www.mediafire.com/file/')) {
                resultsPlaceholder.textContent = 'Por favor, ingresa un enlace de Mediafire válido.';
                resultsPlaceholder.style.color = '#ef4444'; // Rojo para errores
                return;
            }

            // 3. Mostrar un estado de carga
            generateButton.disabled = true;
            generateButton.querySelector('span').textContent = 'Generando...';
            resultsPlaceholder.textContent = 'Buscando el enlace, por favor espera...';
            resultsPlaceholder.style.color = 'white';
            
            // Limpiar resultados anteriores
            const oldResult = document.getElementById('result-content');
            if(oldResult) oldResult.remove();

            try {
                // 4. Llamar a nuestra API
                // Usamos una ruta relativa '/api' porque el front-end y el back-end estarán en el mismo dominio
                const response = await fetch(`/api?url=${encodeURIComponent(mediafireUrl)}`);
                const data = await response.json();

                // 5. Manejar la respuesta de la API
                if (!response.ok || data.error) {
                    throw new Error(data.error || 'Ocurrió un error al generar el enlace.');
                }
                
                // Ocultar el placeholder y mostrar los resultados
                resultsPlaceholder.style.display = 'none';
                displayResults(data);

            } catch (error) {
                resultsPlaceholder.style.display = 'block';
                resultsPlaceholder.textContent = `Error: ${error.message}`;
                resultsPlaceholder.style.color = '#ef4444'; // Rojo para errores
            } finally {
                // 6. Restablecer el botón
                generateButton.disabled = false;
                generateButton.querySelector('span').textContent = 'Generar Enlace';
            }
        });

        // Función para mostrar los resultados de forma ordenada
        function displayResults(data) {
            const resultDiv = document.createElement('div');
            resultDiv.id = 'result-content';
            resultDiv.className = 'flex flex-col gap-3 text-center p-4 bg-[#1b2127] rounded-lg border border-[#3b4754]';

            // Nombre del archivo
            const fileNameEl = document.createElement('p');
            fileNameEl.className = 'text-white';
            fileNameEl.innerHTML = `<strong>Archivo:</strong> ${data.fileName}`;

            // Tamaño del archivo
            const fileSizeEl = document.createElement('p');
            fileSizeEl.className = 'text-white text-sm';
            fileSizeEl.innerHTML = `<strong>Tamaño:</strong> ${data.fileSize}`;
            
            // Enlace de descarga (botón)
            const linkEl = document.createElement('a');
            linkEl.href = data.directLink;
            linkEl.target = '_blank'; // Abrir en nueva pestaña
            linkEl.className = 'mt-2 inline-block w-full cursor-pointer rounded-full h-10 px-4 bg-[#22c55e] text-white text-sm font-bold leading-normal tracking-[0.015em] flex items-center justify-center';
            linkEl.textContent = 'Descargar Archivo';

            resultDiv.appendChild(fileNameEl);
            resultDiv.appendChild(fileSizeEl);
            resultDiv.appendChild(linkEl);

            resultsContainer.appendChild(resultDiv);
        }
    </script>
    </body>
</html>
